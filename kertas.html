<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Frui‑Chan Fortune Slip</title>
  <style>
    :root{
      --bg:#fff8fb;
      --card:#fff;
      --accent:#f6c0d6;
      --text:#5b3b3b;
      --muted:#9b7f7f;
      --paper:#fffdf1;
      --shadow: 0 8px 24px rgba(91,59,59,0.12);
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#fff);color:var(--text)}
    .wrap{min-height:100vh;display:grid;place-items:center;padding:28px}
    .stage{width:980px;max-width:96%;display:flex;gap:28px;align-items:center}

    /* left: mascot */
    .mascot{
      width:360px;max-width:40%;background:transparent;display:flex;flex-direction:column;align-items:center;gap:12px
    }
    .mascot img{width:100%;height:auto;filter:drop-shadow(0 8px 20px rgba(0,0,0,0.08))}
    .mascot .title{font-weight:700;font-size:20px}
    .mascot .subtitle{color:var(--muted);font-size:14px}

    /* right: interactive card */
    .card{flex:1;background:var(--card);border-radius:18px;padding:28px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:16px}
    .card-top{display:flex;justify-content:space-between;align-items:center}
    .brand{display:flex;gap:12px;align-items:center}
    .brand .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,#ffd1d9,#ffd8b3);display:grid;place-items:center;font-weight:800}
    .brand h1{font-size:18px;margin:0}
    .brand p{margin:0;color:var(--muted);font-size:13px}

    .controls{display:flex;gap:10px;align-items:center}
    .btn{background:linear-gradient(180deg,#ffd7e6,#ffc9da);border:none;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 6px 12px rgba(246,192,214,0.35)}
    .btn.ghost{background:transparent;border:1px solid rgba(91,59,59,0.06);box-shadow:none}

    .paper-wrap{display:grid;place-items:center;padding:18px}
    .paper{width:100%;max-width:520px;background:var(--paper);border-radius:12px;padding:22px 18px;box-shadow:0 12px 28px rgba(91,59,59,0.08);min-height:160px;position:relative;overflow:hidden}
    .paper .frui-small{position:absolute;right:14px;top:6px;width:86px;opacity:0.95}
    .message{font-size:18px;line-height:1.3;margin:8px 0;color:var(--text)}
    .meta{display:flex;justify-content:space-between;gap:8px;margin-top:12px}
    .fact{color:var(--muted);font-size:13px}
    .rarity{font-weight:800;color:#9c3d7a}

    /* open animation */
    .hidden{opacity:0;transform:translateY(8px) scale(.98)}
    .reveal{animation:pop .45s cubic-bezier(.2,.9,.3,1) forwards}
    @keyframes pop{from{opacity:0;transform:translateY(18px) scale(.98)}to{opacity:1;transform:none}}

    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:6px}
    .small{font-size:13px;color:var(--muted)}

    /* tiny confetti */
    .confetti{position:absolute;left:0;top:0;pointer-events:none}

    @media (max-width:880px){
      .stage{flex-direction:column}
      .mascot{order:2;width:84%}
      .card{order:1;width:100%}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="stage">
      <div class="mascot">
        <!-- use provided mascot image -->
        <img src="say hiii.png" alt="Frui-Chan smiling">
        <div class="title">Frui‑Chan say hi!</div>
        <div class="subtitle">Scan sekali sehari untuk pesan rahasia manis ✨</div>
      </div>

      <div class="card" role="region" aria-label="Frui Chan Fortune">
        <div class="card-top">
          <div class="brand">
            <div class="logo">FC</div>
            <div>
              <h1>Frui‑Chan Fortune Slip</h1>
              <p>Dapatkan pesan manis, fakta buah, & kesempatan rare!</p>
            </div>
          </div>
          <div class="controls">
            <button class="btn" id="openBtn">Buka Pesan Hari Ini</button>
            <button class="btn ghost" id="againBtn">Coba Lagi</button>
          </div>
        </div>

        <div class="paper-wrap">
          <div class="paper hidden" id="paper">
            <img class="frui-small" src="/mnt/data/e861e4ca-93c6-43b7-93fb-c6640bd27372.png" alt="frui small">
            <div class="message" id="message">Halo! Tekan "Buka Pesan Hari Ini" untuk melihat pesan manis dari Frui‑Chan.</div>
            <div class="meta">
              <div class="fact" id="fact">Fun fact: stroberi bukan berry!</div>
              <div class="rarity" id="rarity">—</div>
            </div>
            <canvas class="confetti" id="confettiCanvas" width="600" height="400" style="display:none"></canvas>
          </div>
        </div>

        <div class="footer">
          <div class="small">Pesan disegarkan setiap 24 jam. Rare slip muncul jarang — semoga beruntung!</div>
          <div>
            <button class="btn ghost" id="shareBtn">Share</button>
            <button class="btn ghost" id="copyBtn">Copy</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // Messages & facts
    const fortunes = {
      common: [
        "Semangat, kamu manis seperti stroberi favoritku! Hari ini pasti enak!",
        "Kalau capek, istirahat sebentar ya. Frui‑Chan bangga sama kamu!",
        "Jangan lupa tersenyum—senyummu lebih manis dari madu.",
        "Pelan‑pelan aja, nikmati momen. Manis itu dinikmati, bukan dikejar.",
        "Makan buah sedikit hari ini, biar energimu meletup seperti jeruk!"
      ],
      luck: [
        "Hari ini keberuntunganmu serasa jeruk super segar—ada hal baik menunggu!",
        "Seseorang akan teringat padamu hari ini. Manis, ya?",
        "Cobalah hal baru hari ini, rasanya bisa se‑segar fruit sando pertama."
      ],
      humor: [
        "Aku jatuh dari keranjang tadi… tapi tetap manis kok. Jangan kayak aku ya!",
        "Kalau kamu cuma makan satu fruit sando… itu kurang. Itu fakta dari ilmuwan buah.",
        "Ada 3 hal penting hari ini: makan, senyum, dan… makan lagi."
      ],
      selfcare: [
        "Minum air dulu, pipiku aja bisa segar karena hidrasi.",
        "Jangan lupa makan buah hari ini, biar kamu glowing kayak aku.",
        "Istirahat sebentar, tidur itu investasi untuk mood manismu."
      ],
      rare: [
        "Rare! Besok mungkin ada kabar baik. Simpan kebaikanmu.",
        "Kamu official 'teman buah' Frui‑Chan hari ini. Selamat!",
        "Hoki manis level ultra! Kamu pantas dapat treat enak hari ini."
      ]
    };

    const facts = [
      "Tahukah kamu? Kiwi punya vitamin C lebih tinggi dari jeruk.",
      "Stroberi bukan berry, tapi pisang iya. Unik ya!",
      "Buah saring air di tubuhmu, jadi hidrasi lebih mudah.",
      "Buah yang berwarna cerah biasanya kaya antioksidan.",
      "Jeruk & kiwi itu booster mood alami—coba aja!"
    ];

    // DOM
    const openBtn = document.getElementById('openBtn');
    const againBtn = document.getElementById('againBtn');
    const shareBtn = document.getElementById('shareBtn');
    const copyBtn = document.getElementById('copyBtn');
    const paper = document.getElementById('paper');
    const messageEl = document.getElementById('message');
    const factEl = document.getElementById('fact');
    const rarityEl = document.getElementById('rarity');
    const confettiCanvas = document.getElementById('confettiCanvas');

    // cooldown logic: once per day
    const KEY = 'fruichan-last-scan';
    function canOpen(){
      const raw = localStorage.getItem(KEY);
      if(!raw) return true;
      try{
        const d = JSON.parse(raw);
        const last = new Date(d);
        const now = new Date();
        // allow once per 24 hours
        return (now - last) > (24*60*60*1000);
      }catch(e){return true}
    }
    function markOpened(){
      localStorage.setItem(KEY, JSON.stringify(new Date()));
    }

    function pickRandom(arr){return arr[Math.floor(Math.random()*arr.length)]}

    function reveal(){
      // decide rarity (rare ~7%)
      const p = Math.random();
      let bucket = 'common';
      let rarityText = 'Common';
      if(p < 0.07){ bucket = 'rare'; rarityText = 'Rare!'; }
      else if(p < 0.25) { bucket = 'luck'; rarityText = 'Lucky'; }
      else {
        // pick from other categories randomly
        const subs = ['common','humor','selfcare'];
        bucket = subs[Math.floor(Math.random()*subs.length)];
        rarityText = 'Common';
      }

      const text = pickRandom(fortunes[bucket]);
      const fact = pickRandom(facts);

      messageEl.textContent = text;
      factEl.textContent = fact;
      rarityEl.textContent = rarityText;

      // animate paper in
      paper.classList.remove('hidden');
      paper.classList.add('reveal');

      // confetti on rare
      if(bucket === 'rare') runConfetti();

      // set cooldown
      markOpened();
      updateButtons();
    }

    function updateButtons(){
      if(canOpen()){
        openBtn.disabled = false;
        openBtn.textContent = 'Buka Pesan Hari Ini';
        againBtn.disabled = true;
      }else{
        openBtn.disabled = true;
        openBtn.textContent = 'Sudah Dibuka Hari Ini';
        againBtn.disabled = false;
      }
    }

    openBtn.addEventListener('click', ()=>{
      if(!canOpen()){return}
      reveal();
    });

    againBtn.addEventListener('click', ()=>{
      // allow manual try again but still respect 24h (so it just shows message why)
      if(!canOpen()){
        alert('Kamu sudah membuka pesan hari ini. Coba lagi besok untuk pesan baru!')
        return;
      }
      reveal();
    });

    shareBtn.addEventListener('click', async ()=>{
      const txt = messageEl.textContent + "\n\n" + factEl.textContent + "\n— Frui‑Chan";
      if(navigator.share){
        try{ await navigator.share({title:'Frui‑Chan Fortune',text:txt}); }
        catch(e){console.log('share cancelled')}
      }else{
        // fallback: open twitter share
        const url = encodeURIComponent(location.href);
        const status = encodeURIComponent(txt + ' ' + location.href);
        window.open('https://twitter.com/intent/tweet?text='+status, '_blank');
      }
    });

    copyBtn.addEventListener('click', async ()=>{
      const txt = messageEl.textContent + "\n\n" + factEl.textContent + "\n— Frui‑Chan";
      try{ await navigator.clipboard.writeText(txt); alert('Tersalin ke clipboard!') }
      catch(e){ alert('Gagal menyalin — please copy manually.'); }
    });

    // tiny confetti implementation
    function runConfetti(){
      const c = confettiCanvas;
      c.style.display = 'block';
      c.width = c.clientWidth || 600; c.height = c.clientHeight || 300;
      const ctx = c.getContext('2d');
      const pieces = [];
      for(let i=0;i<40;i++) pieces.push({x:Math.random()*c.width,y:-20,vy:2+Math.random()*6, size:4+Math.random()*7, color:['#ffd7e6','#ffd8b3','#d8ffd7','#d7e6ff'][Math.floor(Math.random()*4)], rot:Math.random()*360});
      let t=0;
      const id = setInterval(()=>{
        t+=1; ctx.clearRect(0,0,c.width,c.height);
        pieces.forEach(p=>{
          p.x += Math.sin(t/10 + p.size)*0.7;
          p.y += p.vy;
          ctx.save();
          ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180);
          ctx.fillStyle = p.color; ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*1.6);
          ctx.restore();
        });
        if(pieces.every(p=>p.y>c.height+40)){ clearInterval(id); c.style.display='none'; }
      },30);
    }

    // initial
    updateButtons();

    // accessibility: keyboard open
    document.addEventListener('keydown', (e)=>{ if(e.key==='Enter') openBtn.click(); });
  </script>
</body>
</html>
